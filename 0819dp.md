第九章 动态规划part09

# 188.买卖股票的最佳时机IV  
本题是123.买卖股票的最佳时机III 的进阶版  
视频讲解：https://www.bilibili.com/video/BV16M411U7XJ
https://programmercarl.com/0188.%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BAIV.html
- k次交易，状态数量和初始化要根据k来定。逻辑同[123.买卖股票的最佳时机III](./0818dp.md)
- 递推更新状态的循环中，用2步进，每一步都按顺序更新两种状态
- dp[i][j]: 到i天结束时，在不同的持有状态j下能达到的最大受益。0：初始状态，1：第一次持有状态，2：第一次持空状态···，奇数到2k-1都是买入持有、偶数以到2k都是卖出持空
- 递推：持有状态dp[i][x]=max(dp[i-1][x],dp[i][x-1]-prices[i]),持空状态dp[i][y]=max(dp[i-1][y],dp[i][y-1]+prices[i])
```py
def maxProfit(self, k: int, prices: List[int]) -> int:
    # 多笔交易的，用dp

    # 初始化
    max_value = [0] * (2*k+1)
    for i in range(0,2*k+1):
        max_value[i] = 0 if i%2 == 0 else -prices[0]
    # 递推
    for i in range(1,len(prices)):
        for j in range(1,2*k+1,2):
            max_value[j] = max(max_value[j],max_value[j-1]-prices[i]) # j是持有状态
            max_value[j+1] = max(max_value[j+1],max_value[j]+prices[i]) # j+1是持空状态
    return max(max_value)
```


# 309.最佳买卖股票时机含冷冻期 

本题加了一个冷冻期，状态就多了，有点难度，大家要把各个状态分清，思路才能清晰 
视频讲解：https://www.bilibili.com/video/BV1rP4y1D7ku

https://programmercarl.com/0309.%E6%9C%80%E4%BD%B3%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E6%97%B6%E6%9C%BA%E5%90%AB%E5%86%B7%E5%86%BB%E6%9C%9F.html  
- 把持空状态拆分为当天卖出、冷冻期、非冷冻期的持空
- dp[i][j]: i天结束后，处于j状态下所能达到的最大受益。
```
1：持有状态，2：当天卖出，3：冷冻期，4非冷冻期的持空。
1可以是4买入、3买入、1延续；
2是1卖出；
3是2延续；
 4是3延续或者4延续
```
```py
def maxProfit(self, prices: List[int]) -> int:
    # 把持空状态拆分为当天卖出、冷冻期、非冷冻期的持空
    # dp[i][j]: i天结束后，处于j状态下所能达到的最大受益。1：持有状态，2：当天卖出，3：冷冻期，4非冷冻期的持空。1可以是4买入、3买入、1延续；2是1卖出；3是2延续；4是3延续或者4延续

    # 初始化
    max_value = [-prices[0],0,0,0] 
    # 二维递推（用copy保留前一天的状态）
    for i in range(1,len(prices)):
        last_day = max_value.copy()
        max_value[0] = max(last_day[0],last_day[3]-prices[i],last_day[2]-prices[i])
        max_value[1] = last_day[0]+prices[i]
        max_value[2] = last_day[1]
        max_value[3] = max(last_day[3],last_day[2])
    return max(max_value)
```

# 714.买卖股票的最佳时机含手续费  

相对[122.买卖股票的最佳时机II](./0818dp.md)的dp做法 ，本题只需要在计算卖出操作的时候减去手续费就可以了，代码几乎是一样的，可以尝试自己做一做。
视频讲解：https://www.bilibili.com/video/BV1z44y1Z7UR
https://programmercarl.com/0714.%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA%E5%90%AB%E6%89%8B%E7%BB%AD%E8%B4%B9%EF%BC%88%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%EF%BC%89.html
- dp[i][j]: 在i天结束时，j状态下的最大收入。0：持有状态，1：持空状态。卖出时减去手续费
```py
def maxProfit(self, prices: List[int], fee: int) -> int:

    # 初始化
    max_value = [-prices[0],0]
    # 递推
    for i in range(1,len(prices)):
        last_day = max_value.copy()
        max_value[0] = max(last_day[0],last_day[1]-prices[i])
        max_value[1] = max(last_day[1],last_day[0]+prices[i]-fee)
    return max(max_value)
```

 股票总结 

股票问题做一个总结吧
https://programmercarl.com/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92-%E8%82%A1%E7%A5%A8%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%E7%AF%87.html  


